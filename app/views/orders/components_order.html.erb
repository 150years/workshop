<h2 class="text-xl font-bold">Project: <%= @order.name %></h2>
<h2 class="text-lg font-semibold">Quotation: <%= @version.quotation_number %></h2>

<% @grouped_components.each do |category, suppliers_hash| %>
  <h6 class="text-base font-semibold"><%= category.to_s.capitalize %></h6>

  <% suppliers_hash.each do |supplier, components_hash| %>
    <h5>
      <% if supplier&.email.present? %>
        <%= mail_to supplier.email, supplier.name %>
      <% else %>
        <%= supplier&.name || "Unknown" %>
      <% end %>
    </h5>
  </div>

  <% category_hash.each do |category, components| %>
    <div class="flex items-center justify-between mb-2">
      <h6 class="text-base font-semibold"><%= category.capitalize %></h6>
      <%= link_to image_tag('download.svg', size: '16x16'),
                  components_order_pdf_order_path(@order, category:, supplier_id: supplier&.id),
                  target: '_blank',
                  class: 'btn btn--icon text-sm',
                  title: "PDF for #{supplier&.name || 'Unknown'} / #{category}" %>
    </div>

    <table class="prose table mbe-6">
      <thead>
        <tr>
          <th>#</th>
          <th>Image</th>
          <th>Code</th>
          <th>Name</th>
          <th>Color</th>
          <th>Quantity</th>
        </tr>
      </thead>
      <tbody>
        <% components.each_with_index do |(component, quantity), i| %>
          <tr>
            <td><%= i + 1 %></td>
            <td><%= image_or_placeholder(component.image, 150, 150) %></td>
            <td><%= component.code %></td>
            <td><%= component.name %></td>
            <td><%= component.color %></td>
            <td><%= quantity %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
<% end %>
